<!DOCTYPE html>
<html lang="en">
<head>

	<!-- Basic Page Needs
  ================================================== -->
	<meta charset="utf-8">
	<title>BYU Ride Board</title>

	<!-- Mobile Specific Metas
  ================================================== -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="One page parallax responsive HTML Template">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">


	<!-- Favicon -->
	<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico" />

	<!-- CSS
  ================================================== -->
	<!-- Themefisher Icon font -->
	<link rel="stylesheet" href="/plugins/themefisher-font/style.css">
	<!-- bootstrap.min css -->
	<link rel="stylesheet" href="/plugins/bootstrap/bootstrap.min.css">
	<!-- Lightbox.min css -->
	<link rel="stylesheet" href="/plugins/lightbox2/css/lightbox.min.css">
	<!-- animation css -->
	<link rel="stylesheet" href="/plugins/animate/animate.css">
	<!-- Slick Carousel -->
	<link rel="stylesheet" href="/plugins/slick/slick.css">
	<!-- Main Stylesheet -->
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/loginstyles.css">
	<link rel="stylesheet" href="/css/ridestyles.css">

</head>
<body id="body">


	<!--
  Start Preloader
  ==================================== -->
	<div id="preloader">
		<div class='preloader'>
			<span></span>
			<span></span>
			<span></span>
			<span></span>
			<span></span>
			<span></span>
		</div>
	</div>
	<!--
  End Preloader
  ==================================== -->

	<!--
Fixed Navigation
==================================== -->
	<header class="navigation fixed-top">
		<div class="container">
			<!-- main nav -->
			<nav class="navbar navbar-expand-lg navbar-light px-0">
				<!-- logo -->
				<a class="navbar-brand logo" href="/">
					<img loading="lazy" class="logo-default" src="/images/logo.svg" alt="logo" />
					<img loading="lazy" class="logo-white" src="/images/logo-white.svg" alt="logo" />
				</a>
				<!-- /logo -->
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
					aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="navigation">
					<ul class="navbar-nav ml-auto text-center">
						<li class="nav-item ">
							<a class="nav-link" href="/">Home</a>
						</li>
						<% if(!user) { %>

							<li class="nav-item ">
								<a class="nav-link" href="/login">Login</a>
							</li>
							<% } else { %>

								<li class="nav-item ">
									<a class="nav-link" href="/rides">Find a Ride</a>
								</li>

								<li class="nav-item ">
									<a class="nav-link" href="/newride">Post a Ride</a>
								</li>

								<li class="nav-item ">
									<a class="nav-link" href="/account">My Account</a>
								</li>

								<li class="nav-item ">
									<a class="nav-link" href="/logout">Logout</a>
								</li>
								<% } %>


					</ul>
				</div>
			</nav>
			<!-- /main nav -->
		</div>
	</header>
	<!--
End Fixed Navigation
==================================== -->

	<main class="site-content" role="main">
		<section class="service-2 section">
			<table class="table-style" id="survey-results-table">
				<thead>

					<th>
						First name
					</th>
					<th>
						Last Name
					</th>
					<th>
						Email
					</th>
					<th>
						Username
					</th>
					<th>
						Edit
					</th>


				</thead>
				<tbody>
					<% for (let iCount=0; iCount < allAccounts.length; iCount++) { %>
						<tr>
							<td>
								<%= allAccounts[iCount].first_name%>
							</td>
							<td>
								<%= allAccounts[iCount].last_name%>
							</td>
							<td>
								<%= allAccounts[iCount].email%>
							</td>
							<td>
								<%= allAccounts[iCount].username%>
							</td>

							<td class="edit-td">
								<button class="edit-btn btn"
									data-user-id="<%= allAccounts[iCount].user_id %>">Edit</button>
							</td>



						</tr>
						<tr class="edit-form" id="edit-form-<%= allAccounts[iCount].user_id %>" style="display: none;">
							<td colspan="100%">
								<form action="/modify-user" method="post" class="modify-user">
									<label for="">First Name</label>
									<input type="text" name="first_name" value="<%= allAccounts[iCount].first_name%>"
										required>
									<label for="">Last name</label>
									<input type="text" name="last_name" value="<%= allAccounts[iCount].last_name%>"
										required>
									<label for="">Email</label>
									<input type="email" name="email" value="<%= allAccounts[iCount].email%>" required>
									<label for="">Username</label>
									<input type="text" name="username" value="<%= allAccounts[iCount].username%>"
										required>
									<label for="">Update Password</label>
									<input type="password" name="password" value="">

									<div class="btn-span">
										<button type="submit" style="grid-column: 2;" class="btn" id="save-changes">Save
											Changes</button>

										<form id="deleteLogoutUserForm"
											action="/delete-logout-user/<%= allAccounts[iCount].user_id %>"
											method="POST" class="edit-td" onsubmit="return confirmDeleteLogout()">
											<input type="submit" name="Delete" value="Delete" class="btn delete-btn" />
										</form>

									</div>
								</form>


							</td>
						</tr>
						<% } %>
				</tbody>
			</table>
		</section>

		<% if (rides.length===0) { %>
			<h2>My Rides</h2>
			<p>No rides found.</p>
			<% } else { %>

				<section class="service-2 section">
					<!--Header for user rides table-->
					<div style="text-align: center;">
						<h2 style="margin-bottom: 0;">My Rides</h2>
					</div>

					<table class="table-style" id="survey-results-table">
						<thead>
							<tr>
								<th>Ride ID</th>
								<th>Start State</th>
								<th>Start City</th>
								<th>Date Leaving</th>
								<th>Time Leaving</th>
								<th>End City</th>
								<th>End State</th>
							</tr>
						</thead>
						<tbody>
							<% for (let iCount=0; iCount < rides.length; iCount++) { %>
								<tr>
									<td>
										<%= rides[iCount].ride_id %>
									</td>
									<td>
										<%= rides[iCount].start_state %>
									</td>
									<td>
										<%= rides[iCount].start_city %>
									</td>
									<td>
										<%= rides[iCount].end_state %>
									</td>
									<td>
										<%= rides[iCount].end_city %>
									</td>
									<td>
										<%= rides[iCount].formattedDateLeaving %>
									</td>
									<td>
										<%= rides[iCount].formattedTimeLeaving %>
									</td>
								</tr>
								<% } %>
						</tbody>
					</table>
				</section>

				<% } %>

	</main>
	<footer id="footer" class="bg-one">
		<div class="top-footer">
			<div class="container">
				<div class="row justify-content-around">
					<div class="col-lg-4 col-md-6 mb-5 mb-lg-0">
						<h3>about</h3>
						<p>At BYU Ride Board, we're dedicated to simplifying travel for students.
							<br>Our platform fosters
							safe, eco-conscious rides,
							connecting the BYU community.
							<br>With a focus on safety and seamless experiences, we're
							redefining shared journeys, making
							every ride an opportunity for connection and exploration.
						</p>
					</div>
					<!-- End of .col-sm-3 -->

					<div class="col-lg-3 col-md-6 mb-5 mb-lg-0">
						<ul>
							<li>
								<h3>Our Services</h3>
							</li>
							<li><a href="service.html">Post a Ride</a></li>
							<li><a href="service.html">Find a Ride</a></li>
							<li><a href="service.html">Support</a></li>
						</ul>
					</div>
					<!-- End of .col-sm-3 -->


					<!-- End of .col-sm-3 -->


					<!-- End of .col-sm-3 -->

				</div>
			</div> <!-- end container -->
		</div>

	</footer> <!-- end footer -->






	<!-- Main jQuery -->
	<script src="/plugins/jquery/jquery.min.js"></script>

	<!-- Bootstrap4 -->
	<script src="/plugins/bootstrap/bootstrap.min.js"></script>
	<!-- Parallax -->
	<script src="/plugins/parallax/jquery.parallax-1.1.3.js"></script>
	<!-- lightbox -->
	<script src="/plugins/lightbox2/js/lightbox.min.js"></script>
	<!-- Owl Carousel -->
	<script src="/plugins/slick/slick.min.js"></script>

	<!-- Smooth Scroll js -->
	<script src="/plugins/smooth-scroll/smooth-scroll.min.js"></script>


	<!-- Custom js -->
	<script src="/js/script.js"></script>

	<script>
		function confirmDeleteLogout() {
			// Display a confirmation dialog
			var confirmation = confirm("Are you sure you want to delete the user and log out?");

			// If the user confirms, allow form submission; otherwise, cancel it
			return confirmation;
		}
	</script>
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			var editButtons = document.querySelectorAll('.edit-btn');

			editButtons.forEach(function (button) {
				button.addEventListener('click', function () {
					var userId = this.getAttribute('data-user-id');
					var editForm = document.getElementById('edit-form-' + userId);

					// Toggle the display of the edit form
					if (editForm.style.display === 'none') {
						editForm.style.display = 'table-row';
					} else {
						editForm.style.display = 'none';
					}
				});
			});

			// Add logic for saving changes here
			// ...
		});
	</script>

</body>

</html>